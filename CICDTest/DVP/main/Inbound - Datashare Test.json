{"header":{"masterId":86319301,"scriptName":"CICDTest\\DVP\\main\\Inbound - Datashare Test","busNo":4610298,"mediaType":4,"mediaTypeName":"call","purposeType":"General","variableRedaction":"","libraryId":"4ADCD4BE-DC3A-43A6-8802-802FA132AC4F","lockInfo":{"lockedName":"","lockedId":"","lockedDate":""},"nextActionId":27,"status":"Active","lastSavedIn":"api"},"actions":{"1":{"actionId":1,"libraryId":"B2F794C5-0232-40E7-9830-76D573BF57D7","name":"BEGIN","version":1,"label":"Begin","dependencyOrder":"0","implType":"0","x":160,"y":112},"3":{"actionId":3,"libraryId":"93FB8888-30CF-4DF3-8ED9-1F2986819080","name":"END","version":1,"label":"End","dependencyOrder":"1","implType":"0","x":2392,"y":824},"4":{"actionId":4,"libraryId":"DAEE9C00-12CE-4222-A42E-307C37D53B7F","name":"MENU","version":1,"label":"Main Menu","dependencyOrder":"2","implType":"0","x":984,"y":376},"5":{"actionId":5,"libraryId":"B1B9A2DD-65B6-4626-9CF5-9CFA69CF59E2","name":"PLAY","version":1,"label":"Greeting","dependencyOrder":"3","implType":"0","x":968,"y":96},"6":{"actionId":6,"libraryId":"B333DA63-33C8-4297-A58A-E9546CF7F0F2","name":"SNIPPET","version":1,"label":"Set Call Data","dependencyOrder":"4","implType":"0","x":1440,"y":376},"7":{"actionId":7,"libraryId":"689A4A1B-FA0D-47B3-9A02-CBEB4735F08F","name":"REQAGENT","version":1,"label":"Queue to Skill/Agent","dependencyOrder":"5","implType":"0","x":2592,"y":400},"8":{"actionId":8,"libraryId":"DBCC742B-28D8-42D1-9D95-0D9ABF20B04B","name":"MUSIC","version":1,"label":"Hold Music","dependencyOrder":"6","implType":"0","x":2896,"y":400},"9":{"actionId":9,"libraryId":"B1B9A2DD-65B6-4626-9CF5-9CFA69CF59E2","name":"PLAY","version":1,"label":"Queue Message","dependencyOrder":"7","implType":"0","x":2152,"y":376},"10":{"actionId":10,"libraryId":"B1B9A2DD-65B6-4626-9CF5-9CFA69CF59E2","name":"PLAY","version":1,"label":"Hold Message","dependencyOrder":"8","implType":"0","x":3168,"y":616},"11":{"actionId":11,"libraryId":"A10F9F27-A5DD-48BA-AE37-E206FC6E101B","name":"LOOP","version":1,"label":"Hold Loop Counter","dependencyOrder":"9","implType":"0","x":2896,"y":824},"12":{"actionId":12,"libraryId":"8E121149-83EF-40E0-8FFE-341DB5302671","name":"TTSVOICE","version":1,"label":"TTSVOICE","dependencyOrder":"10","implType":"0","x":600,"y":96},"13":{"actionId":13,"libraryId":"9015C095-98D9-441F-BF92-E90F5C5ED8C8","name":"ASSIGN","version":1,"label":"Assign","dependencyOrder":"11","implType":"0","x":352,"y":120},"14":{"actionId":14,"libraryId":"F40B8113-DEE5-405E-8A11-BCF3954047D9","name":"BLINDXFER","version":1,"label":"Blindxfer","dependencyOrder":"12","implType":"0","x":1760,"y":840},"15":{"actionId":15,"libraryId":"6695BA9C-E1D6-4F3C-A15A-94F1400E3169","name":"IF","version":1,"label":"If","dependencyOrder":"13","implType":"0","x":1760,"y":400},"16":{"actionId":16,"libraryId":"B333DA63-33C8-4297-A58A-E9546CF7F0F2","name":"SNIPPET","version":1,"label":"Phone Record Search","dependencyOrder":"14","implType":"0","x":352,"y":376},"17":{"actionId":17,"libraryId":"6DD17D78-7CAE-436A-8796-51BE4947A2F9","name":"AGTINT_WRKFLO_EXE_LIBID_6dd17d78-7cae-436a-8796-51be4947a2f9","version":1,"label":"Workflow Execute - Search","dependencyOrder":"17","implType":"1","x":662,"y":376},"18":{"actionId":18,"libraryId":"4B611BA4-8E81-45A6-9FCC-97C24F43CCBC","name":"ONANSWER","version":1,"label":"Onanswer","dependencyOrder":"15","implType":"0","x":392,"y":1096},"19":{"actionId":19,"libraryId":"F62127BD-385B-4FBD-9AA8-0A1D6CFCFCDA","name":"STOP","version":1,"label":"Stop","dependencyOrder":"16","implType":"0","x":1096,"y":1104},"20":{"actionId":20,"libraryId":"1F31EA92-4E59-407E-B8B1-1BC17AEB8852","name":"AGTINT_WRKFLO_CONFIG","version":1,"label":"Agent Workflow Configuration","dependencyOrder":"18","implType":"0","x":800,"y":1080},"21":{"actionId":21,"libraryId":"B333DA63-33C8-4297-A58A-E9546CF7F0F2","name":"SNIPPET","version":1,"label":"Set Custom Screen-Pop Data","dependencyOrder":"4","implType":"0","x":544,"y":1392},"22":{"actionId":22,"libraryId":"CED6B5FD-6BE3-4BDF-B421-DB92A2474EA7","name":"CUSTOMEVENT","version":1,"label":"CustomEvent","dependencyOrder":"0","implType":"0","x":816,"y":1416},"23":{"actionId":23,"libraryId":"1F31EA92-4E59-407E-B8B1-1BC17AEB8852","name":"AGTINT_WRKFLO_CONFIG","version":1,"label":"Agent Workflow Configuration","dependencyOrder":"18","implType":"0","x":800,"y":1240},"24":{"actionId":24,"libraryId":"F62127BD-385B-4FBD-9AA8-0A1D6CFCFCDA","name":"STOP","version":1,"label":"Stop","dependencyOrder":"16","implType":"0","x":1072,"y":1416},"25":{"actionId":25,"libraryId":"B333DA63-33C8-4297-A58A-E9546CF7F0F2","name":"SNIPPET","version":1,"label":"Incident Record Search","dependencyOrder":"14","implType":"0","x":352,"y":624},"26":{"actionId":26,"libraryId":"6DD17D78-7CAE-436A-8796-51BE4947A2F9","name":"AGTINT_WRKFLO_EXE_LIBID_6dd17d78-7cae-436a-8796-51be4947a2f9","version":1,"label":"Workflow Execute - Search","dependencyOrder":"17","implType":"1","x":662,"y":624}},"properties":{"1":{"0":{"name":"RootFolder","value":""},"1":{"name":"Application","value":""},"2":{"name":"ParamCount","value":""},"3":{"name":"Parameters","value":["Unnamed0"]}},"3":{},"4":{"0":{"name":"Sequence","value":"\"%Press one for Rewards.\nPress two for Cisco Transfer.\""},"1":{"name":"Phrase","value":""},"2":{"name":"ClearDigits","value":"True"},"3":{"name":"MaxDigits","value":"1"},"4":{"name":"Terminator","value":"#-"},"5":{"name":"Timeout","value":"5"},"6":{"name":"InterDigitTimeout","value":"5"},"7":{"name":"Variable","value":"MRES"}},"5":{"0":{"name":"Sequence","value":"\"%Thank you for calling Ford.\""},"1":{"name":"Phrase","value":""},"2":{"name":"ClearDigits","value":"True"},"3":{"name":"DetectDTMF","value":"True"},"4":{"name":"SuppressSilence","value":""},"5":{"name":"TTSVolume","value":""},"6":{"name":"TTSRate","value":""},"7":{"name":"TTSVoice","value":""}},"6":{"0":{"name":"Data","value":"IF test\r\n{\r\n    ASSIGN MRES = 3\r\n}\r\n\r\nSWITCH MRES\r\n{\r\n\tCASE 1 //Option 1\r\n    {\r\n        ASSIGN queueSkill = 6356402\r\n\t\tASSIGN intent = \"Option 1\"\r\n    }\r\n\tCASE 2 //Option 2\r\n\t{\r\n\t\tASSIGN external_xfer = \"+12567551079\"\r\n\t\tASSIGN intent = \"Option 2\"\r\n\t}\r\n\tDEFAULT //No option selected, default action.\r\n\t{\r\n\t\tASSIGN queueSkill = 6356403\r\n\t\tASSIGN intent = \"NoSelection\"\r\n\t} \r\n}\r\n\r\nintent.savetodb(1)"},"1":{"name":"MaxStringSize","value":"Limit2K"}},"7":{"0":{"name":"Skill","value":"{queueSkill}"},"1":{"name":"TargetAgent","value":"{directAgent}"},"2":{"name":"PriorityManagement","value":"DefaultfromSkill"},"3":{"name":"InitialPriority","value":"0"},"4":{"name":"Acceleration","value":"1"},"5":{"name":"Function","value":""},"6":{"name":"MaxPriority","value":"1000"},"7":{"name":"Sequence","value":""},"8":{"name":"ZipTone","value":"AfterSequence"},"9":{"name":"ScreenPopSource","value":"DefaultFromSkill"},"10":{"name":"ScreenPopURL","value":""},"11":{"name":"HighProficiency","value":"1"},"12":{"name":"LowProficiency","value":"20"},"13":{"name":"RoutingAttribute","value":"NotApplicable"}},"8":{"0":{"name":"MusicFile","value":"Autumn-Breezes (soft).wav"},"1":{"name":"StartOffset","value":"0"},"2":{"name":"SecondstoPlay","value":"30"},"3":{"name":"reserved1073742978","value":""},"4":{"name":"InterruptMessages","value":""},"5":{"name":"RepeatIndex","value":""},"6":{"name":"DetectDTMF","value":"False"},"7":{"name":"ClearDigits","value":"True"}},"9":{"0":{"name":"Sequence","value":"\"%Please hold for the next available agent.\""},"1":{"name":"Phrase","value":""},"2":{"name":"ClearDigits","value":"True"},"3":{"name":"DetectDTMF","value":"True"},"4":{"name":"SuppressSilence","value":""},"5":{"name":"TTSVolume","value":""},"6":{"name":"TTSRate","value":""},"7":{"name":"TTSVoice","value":""}},"10":{"0":{"name":"Sequence","value":"\"%Please continue to hold\""},"1":{"name":"Phrase","value":""},"2":{"name":"ClearDigits","value":"True"},"3":{"name":"DetectDTMF","value":"True"},"4":{"name":"SuppressSilence","value":""},"5":{"name":"TTSVolume","value":""},"6":{"name":"TTSRate","value":""},"7":{"name":"TTSVoice","value":""}},"11":{"0":{"name":"Repeat","value":"20"},"1":{"name":"CounterName","value":"C1"}},"12":{"0":{"name":"baseapiurl","value":""},"1":{"name":"vendor","value":"google"},"2":{"name":"voicename","value":"en-US-Chirp3-HD-Despina"},"3":{"name":"BotExchangeVersion","value":""}},"13":{"0":{"name":"Variable","value":"call_entry"},"1":{"name":"Value","value":"Inbound - Datashare Test"},"2":{"name":"Type","value":"String"},"3":{"name":"Publish","value":""},"4":{"name":"ScreenPop","value":"False"},"5":{"name":"SaveToDB","value":"True"},"6":{"name":"MaxStringSize","value":"Limit2K"}},"14":{"0":{"name":"Destination","value":"{external_xfer}"}},"15":{"0":{"name":"Expression","value":"MRES = 2"}},"16":{"0":{"name":"Data","value":"//Search for Phone Record\r\n\r\nDYNAMIC searchInput\r\n\r\nDYNAMIC payload\r\n\r\nsearchid = \"e7e214c4-a171-4379-8d6c-6e77dc512628\"\r\n\r\npayload.entity=\"phonecall\"\r\n\r\n//payload.filter=\"incidentid eq '{incidentid}'\"\r\npayload.filter= \"activityid eq '{searchid}'\"\r\npayload.screenPop = true\r\n\r\nsearchInput.workflowInput.search=payload\r\n \r\nASSIGN searchJson = \"{searchInput.asjson()}\"\r\n\r\n\r\n\r\n//searchJson = searchJson.replace('\\u0026','&')\r\n//searchJson = searchJson.replace('\\u0027',\"\")\r\n \r\n\r\n//ASSIGN baseURL = \"https://tcc-ccas.crm.dynamics.com\"\r\n//ASSIGN query = \"$filter=_customerid_value eq '{msdContactId}' and statecode eq 0&$orderby=modifiedon desc &$top=1\"\r\n//ASSIGN getIncidentURL=\"{baseURL}/api/data/v9.2/incidents?{query}\"\r\n//\r\n//incidentProxy=GetRESTProxy()\r\n//incidentProxy.ContentType =\"application/json\"\r\n//incidentProxy.AddHeader(\"Authorization\", \"Bearer {msd_token}\")\r\n//\r\n//ASSIGN incidentResultSet=incidentProxy.MakeRestRequest(getIncidentURL, \"\" , 0, \"GET\")\r\n//\r\n//ASSIGN incidentId = \"{incidentResultSet.value[1].incidentid}\""},"1":{"name":"MaxStringSize","value":"Limit2K"}},"17":{"0":{"name":"configurationId","value":"9e8e5bb6-1783-4d37-8f11-0df0eaca97c9"},"1":{"name":"workflowId","value":"62607040-76cc-4cd5-bde0-76a874e1fe24"},"2":{"name":"workflowPayload","value":"{searchJson}"},"3":{"name":"Sequence","value":""},"4":{"name":"Phrase","value":""},"5":{"name":"resultSet","value":"workflowResultOutput"},"6":{"name":"errorArgs","value":"workflowErrorOutput"},"7":{"name":"cacheKey","value":"cacheKey1"},"8":{"name":"actionType","value":"Search"},"9":{"name":"dynamicDataMappingId","value":""},"10":{"name":"payload","value":""}},"18":{"0":{"name":"SkillNameVar","value":"SKLNAME"},"1":{"name":"AgentFirstName","value":"FIRST"},"2":{"name":"AgentLastName","value":"LAST"},"3":{"name":"AgentID","value":"AGENTID"}},"19":{},"20":{"0":{"name":"agentUserId","value":"{global:__AgentID}"},"1":{"name":"searchWorkflow","value":"W3siY29uZmlndXJhdGlvbklkIjoiOWU4ZTViYjYtMTc4My00ZDM3LThmMTEtMGRmMGVhY2E5N2M5Iiwid29ya2Zsb3dJZCI6IjYyNjA3MDQwLTc2Y2MtNGNkNS1iZGUwLTc2YTg3NGUxZmUyNCJ9XQ=="},"2":{"name":"timelineWorkflow","value":""},"3":{"name":"dataMemorializationWorkflow","value":""},"4":{"name":"searchCacheKey","value":"{cacheKey1}"},"5":{"name":"searchInput","value":""}},"21":{"0":{"name":"Data","value":"DYNAMIC workflowCustom\r\n\r\nASSIGN workflowCustom.contactId = \"{contactId}\"\r\nASSIGN workflowCustom.result[1].system.type = \"msd\"\r\nASSIGN workflowCustom.result[1].system.label = \"MSD\"\r\nASSIGN workflowCustom.result[1].system.icon = \"\"\r\nASSIGN workflowCustom.result[1].system.baseUrl = \"https://tcc-cfdev2.crm.dynamics.com\"\r\n\r\nASSIGN workflowCustom.result[1].records[1].id = \"e7e214c4-a171-4379-8d6c-6e77dc512628\"\r\nASSIGN workflowCustom.result[1].records[1].type = \"phonecall\"\r\nASSIGN workflowCustom.result[1].records[1].label = \"Phone Call\"\r\nASSIGN workflowCustom.result[1].records[1].display = \"CE - Phone call from 2567551079\"\r\nASSIGN workflowCustom.result[1].records[1].url = \"/main.aspx?forceUCI=1&pagetype=entityrecord&etn=phonecall&id=e7e214c4-a171-4379-8d6c-6e77dc512628\"\r\nASSIGN workflowCustom.result[1].records[1].related[1] = \"\"\r\nASSIGN workflowCustom.result[1].records[1].linkable = \"FALSEPLACEHOLDER\"\r\nASSIGN workflowCustom.result[1].pinRecords[1] = \"\"\r\n\r\nASSIGN searchWorkflowOutputJson = \"{workflowCustom.asjson()}\"\r\n\r\nASSIGN searchWorkflowOutputJson = searchWorkflowOutputJson.replace(\"{char(34)}TRUEPLACEHOLDER{char(34)}\",\"true\")\r\nASSIGN searchWorkflowOutputJson = searchWorkflowOutputJson.replace(\"{char(34)}FALSEPLACEHOLDER{char(34)}\",\"false\")\r\nASSIGN searchWorkflowOutputJson = searchWorkflowOutputJson.replace(\"\\u0026\",\"&\")\r\nASSIGN searchWorkflowOutputJson = searchWorkflowOutputJson.replace(\"{char(123)}{char(125)}\",null)"},"1":{"name":"MaxStringSize","value":"Limit2K"}},"22":{"0":{"name":"TargetAgent","value":"{Global:__agentId}"},"1":{"name":"EventName","value":"AgentWorkflowResponse"},"2":{"name":"PersistInMemory","value":"False"},"3":{"name":"Data","value":"{searchWorkflowOutputJson}"}},"23":{"0":{"name":"agentUserId","value":"{global:__AgentID}"},"1":{"name":"searchWorkflow","value":"W3siY29uZmlndXJhdGlvbklkIjoiOWU4ZTViYjYtMTc4My00ZDM3LThmMTEtMGRmMGVhY2E5N2M5Iiwid29ya2Zsb3dJZCI6IjYyNjA3MDQwLTc2Y2MtNGNkNS1iZGUwLTc2YTg3NGUxZmUyNCJ9XQ=="},"2":{"name":"timelineWorkflow","value":""},"3":{"name":"dataMemorializationWorkflow","value":""},"4":{"name":"searchCacheKey","value":"{cacheKeyIncident}"},"5":{"name":"searchInput","value":""}},"24":{},"25":{"0":{"name":"Data","value":"//Search for Incident Record\r\n\r\nDYNAMIC searchInput\r\n\r\nDYNAMIC payload\r\n\r\nsearchid = \"3502e8ff-f48f-f011-b4cc-6045bdd3cb3f\"\r\n\r\npayload.entity=\"incident\"\r\n\r\npayload.filter= \"incidentid eq '{searchid}'\"\r\npayload.screenPop = true\r\n\r\nsearchInput.workflowInput.search=payload\r\n \r\nASSIGN searchJson = \"{searchInput.asjson()}\"\r\n"},"1":{"name":"MaxStringSize","value":"Limit2K"}},"26":{"0":{"name":"configurationId","value":"9e8e5bb6-1783-4d37-8f11-0df0eaca97c9"},"1":{"name":"workflowId","value":"62607040-76cc-4cd5-bde0-76a874e1fe24"},"2":{"name":"workflowPayload","value":"{searchJson}"},"3":{"name":"Sequence","value":""},"4":{"name":"Phrase","value":""},"5":{"name":"resultSet","value":"workflowResultOutput"},"6":{"name":"errorArgs","value":"workflowErrorOutput"},"7":{"name":"cacheKey","value":"cacheKey1"},"8":{"name":"actionType","value":"Search"},"9":{"name":"dynamicDataMappingId","value":""},"10":{"name":"payload","value":""}}},"branches":{"1":[{"to":13,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"4":[{"to":6,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"5":[{"to":16,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"6":[{"to":15,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"7":[{"to":8,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"8":[{"to":10,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"9":[{"to":7,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"10":[{"to":11,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"11":[{"to":3,"label":"Finished","type":"branch","index":0,"ports":"c,c","lineType":"straight","elbows":[]},{"to":8,"label":"Repeat","type":"branch","index":1,"ports":"c,c","lineType":"straight","elbows":[]}],"12":[{"to":5,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"13":[{"to":12,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"14":[{"to":3,"label":"DialingError","type":"branch","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"15":[{"to":14,"label":"True","type":"branch","index":0,"ports":"c,c","lineType":"straight","elbows":[]},{"to":9,"label":"False","type":"branch","index":1,"ports":"c,c","lineType":"straight","elbows":[]}],"16":[{"to":17,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"17":[{"to":4,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"18":[{"to":20,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"20":[{"to":19,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"21":[{"to":22,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"22":[{"to":24,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"23":[{"to":19,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"25":[{"to":26,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"26":[{"to":4,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}]}}