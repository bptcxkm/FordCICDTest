{"header":{"masterId":86308617,"scriptName":"CICDTest\\DVP\\main\\GBL_Port_Checker","busNo":4610298,"mediaType":4,"mediaTypeName":"call","purposeType":"General","variableRedaction":"","libraryId":"5AEB5D62-AC9D-4424-A946-92A8F690AE82","lockInfo":{"lockedName":"","lockedId":"","lockedDate":""},"nextActionId":32,"status":"Active","lastSavedIn":"api"},"actions":{"1":{"actionId":1,"libraryId":"A2A6D67D-0738-4918-88AE-30565B694230","name":"INFO","version":1,"label":"Info","dependencyOrder":"0","implType":"0","x":400,"y":432},"2":{"actionId":2,"libraryId":"13087702-F8FF-4FDE-B275-D93C08219A5E","name":"GETVALUE","version":1,"label":"LastCheck","dependencyOrder":"1","implType":"0","x":1600,"y":432},"3":{"actionId":3,"libraryId":"9015C095-98D9-441F-BF92-E90F5C5ED8C8","name":"ASSIGN","version":1,"label":"Current Check","dependencyOrder":"2","implType":"0","x":1264,"y":432},"4":{"actionId":4,"libraryId":"9015C095-98D9-441F-BF92-E90F5C5ED8C8","name":"ASSIGN","version":1,"label":"PortPercent","dependencyOrder":"3","implType":"0","x":752,"y":432},"5":{"actionId":5,"libraryId":"9015C095-98D9-441F-BF92-E90F5C5ED8C8","name":"ASSIGN","version":1,"label":"NotifyDiff","dependencyOrder":"4","implType":"0","x":2048,"y":432},"6":{"actionId":6,"libraryId":"29864722-5314-434E-9D61-6E2019A0D9FD","name":"RETURN","version":1,"label":"Return","dependencyOrder":"5","implType":"0","x":976,"y":576},"7":{"actionId":7,"libraryId":"928FADA8-DD9D-46F5-AE9D-94E4565CF0C4","name":"PUTVALUE","version":1,"label":"Putvalue","dependencyOrder":"6","implType":"0","x":2416,"y":672},"8":{"actionId":8,"libraryId":"40419A9E-4AFD-400B-8BA1-5D59E8BAC026","name":"REMVALUE","version":1,"label":"Remvalue","dependencyOrder":"7","implType":"0","x":2416,"y":560},"9":{"actionId":9,"libraryId":"6695BA9C-E1D6-4F3C-A15A-94F1400E3169","name":"IF","version":1,"label":"PortPercent >= 90","dependencyOrder":"8","implType":"0","x":976,"y":432},"10":{"actionId":10,"libraryId":"933F7543-0CD4-4BB3-A403-FBFE14F4D34C","name":"EMAIL","version":1,"label":"Cust Email","dependencyOrder":"9","implType":"0","x":2912,"y":672},"13":{"actionId":13,"libraryId":"B2F794C5-0232-40E7-9830-76D573BF57D7","name":"BEGIN","version":1,"label":"System_PortChecker","dependencyOrder":"8","implType":"0","x":80,"y":432},"14":{"actionId":14,"libraryId":"29864722-5314-434E-9D61-6E2019A0D9FD","name":"RETURN","version":1,"label":"Return","dependencyOrder":"11","implType":"0","x":2912,"y":432},"15":{"actionId":15,"libraryId":"6695BA9C-E1D6-4F3C-A15A-94F1400E3169","name":"IF","version":1,"label":"NotifyDiff > 15 mins","dependencyOrder":"12","implType":"0","x":2416,"y":432},"20":{"actionId":20,"libraryId":"D28D2B39-D4DB-499A-9B8B-F3879E4C5B25","name":"ANNOTATION","version":1,"label":"Annotation","dependencyOrder":"13","implType":"0","x":16,"y":16},"21":{"actionId":21,"libraryId":"D28D2B39-D4DB-499A-9B8B-F3879E4C5B25","name":"ANNOTATION","version":1,"label":"Annotation","dependencyOrder":"14","implType":"0","x":272,"y":336},"22":{"actionId":22,"libraryId":"D28D2B39-D4DB-499A-9B8B-F3879E4C5B25","name":"ANNOTATION","version":1,"label":"Annotation","dependencyOrder":"15","implType":"0","x":624,"y":336},"23":{"actionId":23,"libraryId":"D28D2B39-D4DB-499A-9B8B-F3879E4C5B25","name":"ANNOTATION","version":1,"label":"Annotation","dependencyOrder":"16","implType":"0","x":1200,"y":352},"24":{"actionId":24,"libraryId":"D28D2B39-D4DB-499A-9B8B-F3879E4C5B25","name":"ANNOTATION","version":1,"label":"Annotation","dependencyOrder":"17","implType":"0","x":560,"y":544},"25":{"actionId":25,"libraryId":"D28D2B39-D4DB-499A-9B8B-F3879E4C5B25","name":"ANNOTATION","version":1,"label":"Annotation","dependencyOrder":"18","implType":"0","x":1456,"y":240},"26":{"actionId":26,"libraryId":"D28D2B39-D4DB-499A-9B8B-F3879E4C5B25","name":"ANNOTATION","version":1,"label":"Annotation","dependencyOrder":"19","implType":"0","x":1904,"y":320},"27":{"actionId":27,"libraryId":"D28D2B39-D4DB-499A-9B8B-F3879E4C5B25","name":"ANNOTATION","version":1,"label":"Annotation","dependencyOrder":"20","implType":"0","x":2256,"y":256},"28":{"actionId":28,"libraryId":"D28D2B39-D4DB-499A-9B8B-F3879E4C5B25","name":"ANNOTATION","version":1,"label":"Annotation","dependencyOrder":"21","implType":"0","x":3248,"y":400},"29":{"actionId":29,"libraryId":"D28D2B39-D4DB-499A-9B8B-F3879E4C5B25","name":"ANNOTATION","version":1,"label":"Annotation","dependencyOrder":"22","implType":"0","x":2608,"y":544},"30":{"actionId":30,"libraryId":"D28D2B39-D4DB-499A-9B8B-F3879E4C5B25","name":"ANNOTATION","version":1,"label":"Annotation","dependencyOrder":"23","implType":"0","x":1744,"y":640},"31":{"actionId":31,"libraryId":"D28D2B39-D4DB-499A-9B8B-F3879E4C5B25","name":"ANNOTATION","version":1,"label":"Annotation","dependencyOrder":"24","implType":"0","x":3104,"y":672}},"properties":{"1":{"0":{"name":"AllContacts","value":"CONTACTS"},"1":{"name":"ActiveVoice","value":"VOICE"},"2":{"name":"ActiveEMail","value":"EMAIL"},"3":{"name":"ActiveChat","value":"CHAT"},"4":{"name":"unused1073743154","value":""},"5":{"name":"ActiveCustom","value":""},"6":{"name":"Reserved1","value":""},"7":{"name":"PortCount","value":""},"8":{"name":"ActiveNonMedia","value":""},"9":{"name":"NonMediaPortsAllocated","value":""},"10":{"name":"EmailPortsAllocated","value":"EMAILALLOCATED"},"11":{"name":"unused1073743161","value":""},"12":{"name":"Reserved2","value":""},"13":{"name":"VoicePortsAllocated","value":"VOICEALLOCATED"},"14":{"name":"AllPurposePorts","value":""},"15":{"name":"CustomPortsAllocated","value":""},"16":{"name":"ActiveVoiceMail","value":"VOICEMAIL"},"17":{"name":"ActiveCallback","value":"CALLBACK"},"18":{"name":"ActiveSms","value":"SMS"}},"2":{"0":{"name":"Scope","value":"BusinessUnit"},"1":{"name":"Name","value":"PortChecker"},"2":{"name":"Variable","value":"LastCheck"},"3":{"name":"DefaultValue","value":"0"},"4":{"name":"Remove","value":"False"}},"3":{"0":{"name":"Variable","value":"CurrentCheck"},"1":{"name":"Value","value":"NOW"},"2":{"name":"Type","value":"Numeric"},"3":{"name":"Publish","value":""},"4":{"name":"ScreenPop","value":"False"},"5":{"name":"SaveToDB","value":"False"},"6":{"name":"MaxStringSize","value":"Limit2K"}},"4":{"0":{"name":"Variable","value":"PortPercent"},"1":{"name":"Value","value":"(VOICE/VOICEALLOCATED) *100 \\1"},"2":{"name":"Type","value":"Numeric"},"3":{"name":"Publish","value":""},"4":{"name":"ScreenPop","value":"False"},"5":{"name":"SaveToDB","value":"False"},"6":{"name":"MaxStringSize","value":"Limit2K"}},"5":{"0":{"name":"Variable","value":"NotifyDiff"},"1":{"name":"Value","value":"(CurrentCheck - LastCheck) *86400"},"2":{"name":"Type","value":"Numeric"},"3":{"name":"Publish","value":""},"4":{"name":"ScreenPop","value":"False"},"5":{"name":"SaveToDB","value":"False"},"6":{"name":"MaxStringSize","value":"Limit2K"}},"6":{"0":{"name":"ReturnValue","value":""}},"7":{"0":{"name":"Scope","value":"BusinessUnit"},"1":{"name":"Name","value":"PortChecker"},"2":{"name":"Value","value":"{CurrentCheck}"},"3":{"name":"Method","value":"Append"},"4":{"name":"Persistent","value":"True"},"5":{"name":"TTLhrs","value":"24"}},"8":{"0":{"name":"Scope","value":"BusinessUnit"},"1":{"name":"Name","value":"PortChecker"},"2":{"name":"Value","value":"{LastCheck}"},"3":{"name":"Occurrence","value":"All"}},"9":{"0":{"name":"Expression","value":"PortPercent >= 90"}},"10":{"0":{"name":"MailServer","value":"Automatic"},"1":{"name":"SenderName","value":"inContact Support"},"2":{"name":"SenderAddress","value":"incontactsupport@incontact.com"},"3":{"name":"reserved1073743171","value":""},"4":{"name":"Recipient","value":"{NotificationEmail}"},"5":{"name":"CCRecipient","value":""},"6":{"name":"Subject","value":"ALERT!  Port Notification - {Date} {Time} - {Voice} Ports"},"7":{"name":"Body","value":""},"8":{"name":"HTML","value":"<P>Your inContact account is currently using {Voice} ports and has reached the threshold of 90% of the maximum number of voice ports: {VoiceAllocated}</P>\n<P>To increase your number of ports, please contact your project manager, the client support team, or our 24 hour inContact technical support line at 800-826-8028.</P>"},"9":{"name":"Attachments","value":""},"10":{"name":"ErrorMsgVar","value":"ERRMSG"}},"13":{"0":{"name":"RootFolder","value":""},"1":{"name":"Application","value":""},"2":{"name":"ParamCount","value":""},"3":{"name":"Parameters","value":["NotificationEmail"]}},"14":{"0":{"name":"ReturnValue","value":""}},"15":{"0":{"name":"Expression","value":"NotifyDiff > 900"}},"20":{"0":{"name":"Comments","value":"Notes:\n------\nThis script is used to see if the system is getting close to being out of open ports.  If it is, it will email the system administrator.\nThis script will email the System administrator every 15 minutes until the issue is resolved.\n\n\nIntended Use:\n-------------\nRunSub\n\n\nVariables used:\n---------------\nThis script uses the \"NotificationEmail\" variable that is set in the \"Main_Entry\" script.\n\nReturns:\n--------\nNo values are passed back to parent script.\n\n"},"1":{"name":"Width","value":"523"},"2":{"name":"Height","value":"255"}},"21":{"0":{"name":"Comments","value":"Get port usage"},"1":{"name":"Width","value":"88"},"2":{"name":"Height","value":"32"}},"22":{"0":{"name":"Comments","value":"Determine Percentage Used."},"1":{"name":"Width","value":"103"},"2":{"name":"Height","value":"45"}},"23":{"0":{"name":"Comments","value":"Get Current Time."},"1":{"name":"Width","value":"75"},"2":{"name":"Height","value":"32"}},"24":{"0":{"name":"Comments","value":"Return to parent script that called the runsub.\n\nNo values are passed back to Parent script."},"1":{"name":"Width","value":"116"},"2":{"name":"Height","value":"99"}},"25":{"0":{"name":"Comments","value":"From temporary table called \"PortChecker\" pull in the time of the last check.\n\nTemporary table lasts for 24 hours.\n\nIf no table is found follow \"NoData\" path."},"1":{"name":"Width","value":"145"},"2":{"name":"Height","value":"136"}},"26":{"0":{"name":"Comments","value":"Subtract last check time from current time."},"1":{"name":"Width","value":"134"},"2":{"name":"Height","value":"61"}},"27":{"0":{"name":"Comments","value":"Is the time difference between last check and current time greater than 15 minutes.\n\nTime is determined in seconds.  You can configure more or less time here."},"1":{"name":"Width","value":"157"},"2":{"name":"Height","value":"134"}},"28":{"0":{"name":"Comments","value":"Return to parent script that called the runsub.\n\nNo values are passed back to Parent script."},"1":{"name":"Width","value":"116"},"2":{"name":"Height","value":"99"}},"29":{"0":{"name":"Comments","value":"Remove last check time from temporary table called \"PortChecker\""},"1":{"name":"Width","value":"135"},"2":{"name":"Height","value":"56"}},"30":{"0":{"name":"Comments","value":"Create temporary table called \"PortChecker\" if it doesn't already exist.\n\nTable will exist for 24 hours.\n\nStore the current time as \"last Check\".  Used for future comparison."},"1":{"name":"Width","value":"209"},"2":{"name":"Height","value":"90"}},"31":{"0":{"name":"Comments","value":"Send email to notification list in NotificationEmail variable."},"1":{"name":"Width","value":"187"},"2":{"name":"Height","value":"41"}}},"branches":{"1":[{"to":4,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"2":[{"to":5,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]},{"to":7,"label":"NoData","type":"branch","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"3":[{"to":2,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"4":[{"to":9,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"5":[{"to":15,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"7":[{"to":10,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"8":[{"to":7,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"9":[{"to":3,"label":"True","type":"branch","index":0,"ports":"c,c","lineType":"straight","elbows":[]},{"to":6,"label":"False","type":"branch","index":1,"ports":"c,c","lineType":"straight","elbows":[]}],"10":[{"to":14,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"13":[{"to":1,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"15":[{"to":8,"label":"True","type":"branch","index":0,"ports":"c,c","lineType":"straight","elbows":[]},{"to":14,"label":"False","type":"branch","index":1,"ports":"c,c","lineType":"straight","elbows":[]}],"21":[{"to":1,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"22":[{"to":4,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"23":[{"to":3,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"24":[{"to":6,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"25":[{"to":2,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"26":[{"to":5,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"27":[{"to":15,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"28":[{"to":14,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"29":[{"to":8,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"30":[{"to":7,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}],"31":[{"to":10,"label":"","type":"default","index":0,"ports":"c,c","lineType":"straight","elbows":[]}]}}